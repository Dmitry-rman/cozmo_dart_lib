# Cozmo Dart Client - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üéØ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **‚úÖ Reliable UDP** ‚Äî —Ä–µ—Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏—è –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ –∫–∞–∫ –≤ TCP
- **‚úÖ Sliding Window** ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª—å –ø–æ—Ç–æ–∫–∞ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º –¥–æ—Å—Ç–∞–≤–∫–∏
- **‚úÖ Skip-to-Live** ‚Äî –∞—É–¥–∏–æ "–¥–æ–≥–æ–Ω—è–µ—Ç" —Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
- **‚úÖ –ü—Ä–æ—Å—Ç–æ–µ API** ‚Äî topLevel —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ä–∞–±–æ—Ç—ã
- **‚úÖ –°–∏–Ω–≥–ª—Ç–æ–Ω** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º
- **‚úÖ –ë–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** ‚Äî —Ç–æ–ª—å–∫–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã Dart
- **‚úÖ Flutter –≥–æ—Ç–æ–≤** ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ iOS, Android, macOS
- **üìä –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞** ‚Äî –ª–æ–≥–∏ –≤—Å–µ—Ö –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤

## üÜï v3.2.0 ‚Äî –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∏–º–∞—Ü–∏–π! üé¨

**50+ –ê–ù–ò–ú–ê–¶–ò–ô** ‚Äî —Ç–µ–ø–µ—Ä—å Cozmo –º–æ–∂–µ—Ç —Ç–∞–Ω—Ü–µ–≤–∞—Ç—å, celebrating, –∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —ç–º–æ—Ü–∏–∏ —á–µ—Ä–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–∏!
- ‚úÖ **CozmoAnimation enum** ‚Äî 50+ –≥–æ—Ç–æ–≤—ã—Ö –∞–Ω–∏–º–∞—Ü–∏–π (dance, celebrate, sleep, –∏ –¥—Ä.)
- ‚úÖ **playAnimation()** ‚Äî –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∞–Ω–∏–º–∞—Ü–∏–π –ø–æ enum
- ‚úÖ **playAnimationByName()** ‚Äî –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –ø–æ –∏–º–µ–Ω–∏ (—Å—Ç—Ä–æ–∫–∞)
- ‚úÖ **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º–µ–Ω** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π Trigger ID

**–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∞–Ω–∏–º–∞—Ü–∏–π:**
- –ü—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ –∏ —Å–æ–Ω: wakeUp, sleep, yawn
- –°—á–∞—Å—Ç—å–µ: happyPounce, excited, celebrate, majorWin
- –¢–∞–Ω—Ü—ã: dance, danceSprint, moonwalk
- –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ: greeting, yes, no, love
- –ò–≥—Ä—ã: game_win, game_lose
- –ò 40+ –¥—Ä—É–≥–∏—Ö!

## üÜï v3.1.0 ‚Äî –≠–º–æ—Ü–∏–∏! üé≠

**13 –≠–ú–û–¶–ò–ô** ‚Äî Cozmo –º–æ–∂–µ—Ç –≤—ã—Ä–∞–∂–∞—Ç—å —ç–º–æ—Ü–∏–∏!
- ‚úÖ **CozmoEmotion enum** ‚Äî happy, sad, surprised, thinking, –∏ –¥—Ä.
- ‚úÖ **playEmotion()** ‚Äî –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —ç–º–æ—Ü–∏–π

## üÜï v3.0.0 ‚Äî Reliable UDP Layer! üöÄ

**–†–ï–í–û–õ–Æ–¶–ò–û–ù–ù–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê** ‚Äî —Ç–µ–ø–µ—Ä—å –∫–ª–∏–µ–Ω—Ç –≤–µ–¥–µ—Ç —Å–µ–±—è –∫–∞–∫ TCP!
- ‚úÖ **–†–µ—Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏—è** ‚Äî –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –ø–µ—Ä–µ–æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è (RTO = 40–º—Å)
- ‚úÖ **Sliding Window** ‚Äî –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ (size = 8)
- ‚úÖ **Skip-to-Live** ‚Äî –∞—É–¥–∏–æ "–¥–æ–≥–æ–Ω—è–µ—Ç" —Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –ø—Ä–∏ –æ—Ç—Å—Ç–∞–≤–∞–Ω–∏–∏
- ‚úÖ **–ì–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª (_tick)** ‚Äî –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- ‚úÖ **PING Keep-Alive** ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –±–µ–∑ —Ä–∞–∑—Ä—ã–≤–æ–≤
- ‚úÖ **Deadlock-free** ‚Äî –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –∏–∑–±–µ–≥–∞–µ—Ç –≤–∑–∞–∏–º–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

- ‚úÖ **Reliable UDP Layer** ‚Äî —Ä–µ—Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏—è, sliding window, flow control
- ‚úÖ **SetHeadAngle** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–æ–ª–æ–≤–æ–π (-0.436 = –≤–Ω–∏–∑, 0.0 = –ø—Ä—è–º–æ, 0.777 = –≤–≤–µ—Ä—Ö)
- ‚úÖ **SetLiftHeight** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥—ä—ë–º–Ω–∏–∫–æ–º (32mm = –≤–Ω–∏–∑, 92mm = –≤–≤–µ—Ä—Ö)
- ‚úÖ **SetVolume** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ—Å—Ç—å—é (0-100%)
- ‚úÖ **PlayAudio** ‚Äî –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ WAV —Ñ–∞–π–ª–æ–≤ (22050Hz, 16-bit PCM, mono)
- ‚úÖ **DriveWheels** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–µ—Å–∞–º–∏ (–≤–ø–µ—Ä–µ–¥, –Ω–∞–∑–∞–¥, –ø–æ–≤–æ—Ä–æ—Ç)
- ‚úÖ **Bi-Directional Communication** ‚Äî –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –ø—Ä–∏—ë–º/–æ—Ç–ø—Ä–∞–≤–∫–∞ UDP –ø–∞–∫–µ—Ç–æ–≤

### –ü—Ä–µ–¥—ã–¥—É—â–∏–µ –≤–µ—Ä—Å–∏–∏:

**v2.0.0** ‚Äî Flow Control –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –∞—É–¥–∏–æ

**v1.3.0** ‚Äî –ë–∞–∑–æ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Cozmo

**v1.2.0** ‚Äî ROBOT Frame Handling (—Å–æ–±—ã—Ç–∏—è –æ—Ç —Ä–æ–±–æ—Ç–∞)

**v1.1.0** ‚Äî UDP Receive Loop (–ø—Ä–∏—ë–º –æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç Cozmo)

–ü–æ–¥—Ä–æ–±–Ω–µ–µ:
- [CHANGELOG.md](CHANGELOG.md) ‚Äî –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
- [RECEIVE_LOOP_IMPLEMENTATION.md](RECEIVE_LOOP_IMPLEMENTATION.md) ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è receive loop
- [PROTOCOL_REFERENCE.md](PROTOCOL_REFERENCE.md) ‚Äî –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
- [QUICK_REFERENCE.md](QUICK_REFERENCE.md) ‚Äî –±—ã—Å—Ç—Ä–∞—è —à–ø–∞—Ä–≥–∞–ª–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –î–æ–±–∞–≤—å—Ç–µ —Ñ–∞–π–ª –≤ –ø—Ä–æ–µ–∫—Ç

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `cozmo_dart.dart` –≤ –ø–∞–ø–∫—É `lib/` –≤–∞—à–µ–≥–æ Flutter –ø—Ä–æ–µ–∫—Ç–∞:

```
my_flutter_app/
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ cozmo_dart.dart  # ‚Üê –°—é–¥–∞
‚îÇ   ‚îî‚îÄ‚îÄ main.dart
```

### 2. –î–æ–±–∞–≤—å—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ `pubspec.yaml`

```yaml
dependencies:
  flutter:
    sdk: flutter
```

–ë–æ–ª—å—à–µ –Ω–∏–∫–∞–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –Ω–µ –Ω—É–∂–Ω–æ! –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã Dart.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä

```dart
import 'package:my_flutter_app/cozmo_dart.dart';

void main() async {
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º topLevel —Ñ—É–Ω–∫—Ü–∏–∏
  final error = await connect();
  if (error != null) {
    print('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: $error');
    return;
  }

  // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∞—É–¥–∏–æ (16-bit PCM, 22.05kHz, mono)
  await playAudio('/path/to/audio.wav');

  // –û—Ç–∫–ª—é—á–µ–Ω–∏–µ
  await disconnect();
}
```

## üî¨ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ó–ù–ê–ù–ò–Ø - –ü—Ä–∏—Ä–æ–¥–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞

### ‚ö†Ô∏è "–ù–∞–¥–µ–∂–Ω—ã–π UDP" (Reliable UDP)

**–°–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ:** Cozmo –∏—Å–ø–æ–ª—å–∑—É–µ—Ç UDP, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏—è –∫–∞–∫ —É TCP!

#### –°—Ç—Ä–æ–≥–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
```
–û—Ç–ø—Ä–∞–≤–∏–ª–∏: –ü–∞–∫–µ—Ç 1 ‚Üí –ü–∞–∫–µ—Ç 2 ‚Üí –ü–∞–∫–µ—Ç 3
–ü–æ—Ç–µ—Ä—è–Ω: –ü–∞–∫–µ—Ç 2
–†–µ–∑—É–ª—å—Ç–∞—Ç: –ü–∞–∫–µ—Ç 3 –í–´–ë–†–û–°–ï–ù! –†–æ–±–æ—Ç –∂–¥–µ—Ç –ü–∞–∫–µ—Ç 2 –¥–æ –ø–æ–±–µ–¥–Ω–æ–≥–æ.
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ:** –õ—é–±–∞—è –ø–æ—Ç–µ—Ä—è –ø–∞–∫–µ—Ç–∞ —Ä–∞–∑—Ä—ã–≤–∞–µ—Ç –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –Ω–∞–≤—Å–µ–≥–¥–∞ (–µ—Å–ª–∏ –Ω–µ—Ç —Ä–µ—Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–∏).

#### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è —Ä–µ—Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏—è
```dart
// ‚ùå –ü–õ–û–•–û - –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ –∏ –∑–∞–±—ã–ª–∏
socket.send(packet);
// –ü–∞–∫–µ—Ç –ø–æ—Ç–µ—Ä—è–ª—Å—è ‚Üí —Ä–æ–±–æ—Ç –∑–∞–≤–∏—Å –≤ –æ–∂–∏–¥–∞–Ω–∏–∏ ‚Üí connection dead

// ‚úÖ –•–û–†–û–®–û - —Ö—Ä–∞–Ω–∏–º –∏ –ø–µ—Ä–µ–æ—Ç–ø—Ä–∞–≤–ª—è–µ–º
_inflightPackets[seq] = packet;
// –ï—Å–ª–∏ ack –Ω–µ –ø—Ä–∏—à–µ–ª ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–Ω–æ–≤–∞ —á–µ—Ä–µ–∑ RTO (20-30–º—Å)
```

**–ë–µ–∑ —Ä–µ—Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–∏:** –õ—é–±–æ–π –ª–∞–≥ Wi-Fi —Ä–∞–∑—Ä—ã–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.

---

### üéµ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –ê—É–¥–∏–æ (Audio Tuning)

–ß—Ç–æ–±—ã –∑–≤—É–∫ –±—ã–ª –ø–ª–∞–≤–Ω—ã–º, –∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ —Ä–≤–∞–ª–æ—Å—å:

#### 1. –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ (Window Size)

```dart
static const int _WINDOW_SIZE = 32; // –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: 32-48
```

| –†–∞–∑–º–µ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|--------|----------|-----------|
| **4-8** | –ú–∞–ª–µ–Ω—å–∫–æ–µ –æ–∫–Ω–æ | ‚ùå –õ—é–±–æ–π –ª–∞–≥ –æ–ø—É—Å—Ç–æ—à–∞–µ—Ç –±—É—Ñ–µ—Ä ‚Üí —â–µ–ª—á–∫–∏/—Ç–∏—à–∏–Ω–∞ |
| **16** | –°—Ä–µ–¥–Ω–µ–µ –æ–∫–Ω–æ | ‚ö†Ô∏è –†–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –Ω–µ—É—Å—Ç–æ–π—á–∏–≤–æ –ø—Ä–∏ –ø–ª–æ—Ö–æ–º Wi-Fi |
| **32-48** | –ë–æ–ª—å—à–æ–µ –æ–∫–Ω–æ | ‚úÖ ~1 —Å–µ–∫—É–Ω–¥–∞ –∑–≤—É–∫–∞ –≤ –∑–∞–ø–∞—Å–µ ‚Üí –ø–ª–∞–≤–Ω–æ |
| **64+** | –û—á–µ–Ω—å –±–æ–ª—å—à–æ–µ | ‚ö†Ô∏è –ë–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞, –Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ |

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **32-48** –¥–ª—è –∞—É–¥–∏–æ.

#### 2. –¢–∞–π–º–∞—É—Ç –ø–µ—Ä–µ–æ—Ç–ø—Ä–∞–≤–∫–∏ (RTO - Retransmission Timeout)

```dart
static const int _RTO_MS = 25; // –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: 20-30 –º—Å
```

**–ü–æ—á–µ–º—É 20-30–º—Å?**
- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞—É–¥–∏–æ –ø–∞–∫–µ—Ç–∞ = **~33.7 –º—Å** (744 —Å—ç–º–ø–ª–æ–≤ @ 22050Hz)
- –ï—Å–ª–∏ –ø–∞–∫–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω ‚Üí –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–æ—Ç–ø—Ä–∞–≤–∏—Ç—å **–î–û** —Ç–æ–≥–æ, –∫–∞–∫ —Ä–æ–±–æ—Ç –¥–æ–∏–≥—Ä–∞–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–π
- –ï—Å–ª–∏ RTO > 33–º—Å ‚Üí –±—É–¥–µ—Ç —â–µ–ª—á–æ–∫ –∏–ª–∏ —Ç–∏—à–∏–Ω–∞

```
–ü–∞–∫–µ—Ç 1: [0...........33–º—Å]
–ü–∞–∫–µ—Ç 2: [–ü–û–¢–ï–†–Ø–ù] ‚Üê –ü–µ—Ä–µ–æ—Ç–ø—Ä–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ 25–º—Å!
–ü–∞–∫–µ—Ç 3:        [33...........66–º—Å] ‚Üê –†–æ–±–æ—Ç —É–∂–µ –∂–¥–µ—Ç –¥–∞–Ω–Ω—ã—Ö
```

#### 3. Command ID –¥–ª—è –∞—É–¥–∏–æ

```dart
// ‚ùå –ü–õ–û–•–û - "–≥–æ–ª—ã–µ" u-law –¥–∞–Ω–Ω—ã–µ
socket.send(uLawData); // –†–æ–±–æ—Ç –ø—ã—Ç–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª–Ω–∏—Ç—å –∫–∞–∫ –∫–æ–¥ ‚Üí –∫—Ä–∞—à

// ‚úÖ –•–û–†–û–®–û - –æ–±–µ—Ä–Ω—É—Ç—å –≤ –∫–æ–º–∞–Ω–¥—É 0x8e (OutputAudio)
final packet = _createCommandPacket(0x8e, uLawData);
sendCommand(0x8e, uLawData);
```

---

### üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–∫–µ—Ç–æ–≤ –∏ Sequence Numbers

#### –ù–∏–∫–∞–∫–∏—Ö –ø—É—Å—Ç—ã—Ö ENGINE —Ñ—Ä–µ–π–º–æ–≤!

```dart
// ‚ùå –°–ú–ï–†–¢–ï–õ–¨–ù–û - –ø—É—Å—Ç–æ–π ENGINE —Ñ—Ä–µ–π–º
_sendFrame([]); // seq++ –Ω–æ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö!
// –†–æ–±–æ—Ç: "seq –≤—ã—Ä–æ—Å, –Ω–æ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç? –û—à–∏–±–∫–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞!" ‚Üí disconnect
```

**–ü—Ä–∞–≤–∏–ª–æ:** ENGINE (0x07) —Ñ—Ä–µ–π–º—ã –í–°–ï–ì–î–ê —Å–æ–¥–µ—Ä–∂–∞—Ç —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –ø–∞–∫–µ—Ç.

#### PING (0x0b) –¥–ª—è Keep-Alive

```dart
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - PING –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç seq
void _sendPing() {
  w.writeUint8(0x0b); // PING —Ç–∏–ø
  w.writeUint16(0);   // seq = 0 (out-of-band)
  w.writeUint16(0);
  w.writeUint16(_lastAck); // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ
  // ... —Ç–µ–ª–æ –ø–∏–Ω–≥–∞ ...
}
```

**PING –±–µ–∑–æ–ø–∞—Å–µ–Ω:**
- –ù–ï —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç sequence number
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è keep-alive –≤ –ø—Ä–æ—Å—Ç–æ–µ
- –ú–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∫–æ–≥–¥–∞ –æ–∫–Ω–æ –∑–∞–±–∏—Ç–æ

---

### üåä Flow Control (–ö–æ–Ω—Ç—Ä–æ–ª—å –ø–æ—Ç–æ–∫–∞)

#### Deadlock (–í–∑–∞–∏–º–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞)

```dart
// ‚ùå –ü–õ–û–•–û - –±–ª–æ–∫–∏—Ä—É–µ–º –≤—Å—ë (–≤–∫–ª—é—á–∞—è PING!)
while (_inflightPackets.length > _WINDOW_SIZE) {
  await Future.delayed(Duration(milliseconds: 5));
  // –ú—ã –∂–¥–µ–º ACK –æ—Ç —Ä–æ–±–æ—Ç–∞
  // –ù–æ –†–û–ë–û–¢ —Ç–æ–∂–µ –∂–¥–µ—Ç PING –æ—Ç –Ω–∞—Å!
  // ‚Üí Deadlock ‚Üí disconnect —á–µ—Ä–µ–∑ 5 —Å–µ–∫
}
```

#### –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥

```dart
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –≥–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª (_tick)
void _tick(Timer timer) {
  // 1. –†–µ—Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏—è –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã—Ö
  _retransmitTimeoutPackets();

  // 2. –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–æ–≤—ã—Ö (–µ—Å–ª–∏ –æ–∫–Ω–æ —Å–≤–æ–±–æ–¥–Ω–æ)
  if (_inflightPackets.length < _WINDOW_SIZE) {
    _sendNewPackets();
  }

  // 3. Keep-Alive (–≤—Å–µ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º PING!)
  if (now.difference(_lastSendTime) > 1 second) {
    _sendPing(); // –î–∞–∂–µ –µ—Å–ª–∏ –æ–∫–Ω–æ –∑–∞–±–∏—Ç–æ!
  }
}
```

**–ö–ª—é—á–µ–≤–æ–π –ø—Ä–∏–Ω—Ü–∏–ø:** PING –¥–æ–ª–∂–µ–Ω –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è **–í–°–ï–ì–î–ê**, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–∫–Ω–∞.

---

### ‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

#### –ê—É–¥–∏–æ —Ñ–æ—Ä–º–∞—Ç
```dart
const int COZMO_SAMPLE_RATE = 22050;      // 22.05 kHz
const int AUDIO_PACKET_SAMPLES = 744;     // 744 —Å—ç–º–ø–ª–æ–≤
const int PACKET_DURATION_MS = 33.7;      // ~33.7 –º—Å –Ω–∞ –ø–∞–∫–µ—Ç
```

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ WAV
```
–§–æ—Ä–º–∞—Ç: 16-bit PCM, Mono
–ß–∞—Å—Ç–æ—Ç–∞: 22050 Hz (–ò–õ–ò 24000 Hz –ø–æ—Å–ª–µ —Ä–µ—Å–µ–º–ø–ª–∏–Ω–≥–∞)
–ö–æ–¥–µ–∫: u-law (8-bit compressed)
```

#### Frame ID
```dart
const List<int> FRAME_ID = [0x43, 0x4F, 0x5A, 0x03, 0x52, 0x45, 0x01];
// –°—Ç—Ä–æ–∫–∞: "COZ\x03RE\x01" (7 –±–∞–π—Ç)
// –í–°–ï–ì–î–ê –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ø–∞–∫–µ—Ç–∞!
```

---

### üîÑ –ò–¥–µ–∞–ª—å–Ω—ã–π —Ü–∏–∫–ª (_tick)

**–ê–ª–≥–æ—Ä–∏—Ç–º Reliable UDP Layer:**

```dart
void _tick(Timer timer) {
  // 1. –£–î–ê–õ–ò–¢–¨ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–æ–µ
  // –†–æ–±–æ—Ç –ø—Ä–∏—Å–ª–∞–ª ack=42 ‚Üí —É–¥–∞–ª—è–µ–º –≤—Å–µ –ø–∞–∫–µ—Ç—ã —Å seq ‚â§ 42
  _inflightPackets.removeWhere((seq, pkt) =>
    _getSeqDistance(seq, _lastRemoteAck) <= 0
  );

  // 2. –†–ï–¢–†–ê–ù–°–ö–ú–ò–°–°–ò–Ø –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã—Ö
  // –ï—Å–ª–∏ –ø–∞–∫–µ—Ç –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω > RTO_MS ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–Ω–æ–≤–∞
  for (var pkt in _inflightPackets.values) {
    if (now.difference(pkt.lastSentTime).inMilliseconds > _RTO_MS) {
      _sendRaw(pkt.frameData);
      pkt.lastSentTime = now;
      pkt.retries++;
      return; // –û—Ç–ø—Ä–∞–≤–∏–ª–∏ –æ–¥–∏–Ω ‚Üí –≤—ã—Ö–æ–¥–∏–º
    }
  }

  // 3. –û–¢–ü–†–ê–í–ò–¢–¨ –Ω–æ–≤—ã–µ (–µ—Å–ª–∏ –æ–∫–Ω–æ —Å–≤–æ–±–æ–¥–Ω–æ)
  while (_inflightPackets.length < _WINDOW_SIZE &&
         _outboundQueue.isNotEmpty) {
    final payload = _outboundQueue.removeFirst();
    _sendReliableFrame(payload);
  }

  // 4. KEEP-ALIVE (PING)
  // –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏ > 1 —Å–µ–∫ ‚Üí —à–ª–µ–º PING
  if (now.difference(_lastSendTime).inMilliseconds > 1000) {
    _sendPing();
  }
}
```

**–ü–æ—Ä—è–¥–æ–∫ –≤–∞–∂–µ–Ω:**
1. –°–Ω–∞—á–∞–ª–∞ –æ—á–∏—Å—Ç–∏—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ
2. –ó–∞—Ç–µ–º —Ä–µ—Ç—Ä–∞–Ω—Å–ª–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ
3. –ü–æ—Ç–æ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ
4. –í—Å–µ–≥–¥–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å keep-alive

---

## üì± Flutter –ü—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –í–∏–¥–∂–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```dart
import 'package:flutter/material.dart';
import 'cozmo_dart.dart';

class CozmoScreen extends StatefulWidget {
  @override
  _CozmoScreenState createState() => _CozmoScreenState();
}

class _CozmoScreenState extends State<CozmoScreen> {
  bool _isConnected = false;
  bool _isPlaying = false;
  double _progress = 0.0;

  @override
  void initState() {
    super.initState();
    _connect();
  }

  Future<void> _connect() async {
    final error = await connect();
    if (error == null) {
      setState(() => _isConnected = true);
    } else {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: $error')),
      );
    }
  }

  Future<void> _playAudio() async {
    if (!_isConnected) return;

    setState(() => _isPlaying = true);
    _progress = 0.0;

    try {
      // –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ path_provider –¥–ª—è –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã—Ö –ø—É—Ç–µ–π)
      final audioPath = '/path/to/audio.wav';

      await playAudio(
        audioPath,
        onProgress: (progress) {
          setState(() => _progress = progress);
        },
      );
    } catch (e) {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text('–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è: $e')),
      );
    } finally {
      setState(() => _isPlaying = false);
    }
  }

  @override
  void dispose() {
    if (_isConnected) {
      disconnect();
    }
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Cozmo Control'),
      ),
      body: Padding(
        padding: EdgeInsets.all(16.0),
        child: Column(
          children: [
            // –°—Ç–∞—Ç—É—Å
            Card(
              child: ListTile(
                leading: Icon(
                  _isConnected ? Icons.bluetooth_connected : Icons.bluetooth_disabled,
                  color: _isConnected ? Colors.green : Colors.red,
                ),
                title: Text(_isConnected ? '–ü–æ–¥–∫–ª—é—á–µ–Ω–æ' : '–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ'),
                trailing: _isConnected
                    ? ElevatedButton(
                        onPressed: () async {
                          await disconnect();
                          setState(() => _isConnected = false);
                        },
                        child: Text('–û—Ç–∫–ª—é—á–∏—Ç—å'),
                      )
                    : ElevatedButton(
                        onPressed: _connect,
                        child: Text('–ü–æ–¥–∫–ª—é—á–∏—Ç—å'),
                      ),
              ),
            ),

            // –ü—Ä–æ–≥—Ä–µ—Å—Å
            if (_isPlaying)
              Card(
                child: Padding(
                  padding: EdgeInsets.all(16.0),
                  child: Column(
                    children: [
                      Text('–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ...'),
                      SizedBox(height: 8),
                      LinearProgressIndicator(value: _progress),
                      SizedBox(height: 8),
                      Text('${(_progress * 100).toStringAsFixed(0)}%'),
                    ],
                  ),
                ),
              ),

            // –ö–Ω–æ–ø–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
            Card(
              child: ListTile(
                leading: Icon(Icons.play_arrow),
                title: Text('–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∞—É–¥–∏–æ'),
                onTap: _isConnected && !_isPlaying ? _playAudio : null,
              ),
            ),
          ],
        ),
      ),
    );
  }
}
```

### –ü—Ä–∏–º–µ—Ä 2: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è WAV –≤ Flutter

```dart
import 'dart:io';
import 'package:path_provider/path_provider.dart';

Future<String> generateTestWav() async {
  final directory = await getApplicationDocumentsDirectory();
  final file = File('${directory.path}/test.wav');

  // –°–æ–∑–¥–∞—ë–º –ø—Ä–æ—Å—Ç–æ–π WAV —Ñ–∞–π–ª (16-bit PCM, 22.05kHz, mono)
  final sampleRate = 22050;
  final duration = 1; // 1 —Å–µ–∫—É–Ω–¥–∞
  final numSamples = sampleRate * duration;

  final writer = file.openWrite();

  // WAV Header
  writer.write('RIFF'); // ChunkID
  writer.write(36 + numSamples * 2); // ChunkSize (–±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–æ –ø–æ–∑–∂–µ)
  writer.write('WAVE'); // Format

  writer.write('fmt '); // Subchunk1ID
  writer.write(16); // Subchunk1Size (for PCM)
  writer.write(1); // AudioFormat (PCM = 1)
  writer.write(1); // NumChannels (mono)
  writer.write(sampleRate); // SampleRate
  writer.write(sampleRate * 2); // ByteRate
  writer.write(2); // BlockAlign
  writer.write(16); // BitsPerSample

  writer.write('data'); // Subchunk2ID
  writer.write(numSamples * 2); // Subchunk2Size

  // Audio Data (–ø—Ä–æ—Å—Ç–∞—è —Å–∏–Ω—É—Å–æ–∏–¥–∞ 440 Hz)
  for (int i = 0; i < numSamples; i++) {
    final t = i / sampleRate;
    final sample = (sin(2 * pi * 440 * t) * 32767).round();
    writer.write(sample & 0xFF); // Little-endian
    writer.write((sample >> 8) & 0xFF);
  }

  await writer.close();

  return file.path;
}
```

### –ü—Ä–∏–º–µ—Ä 3: –ó–∞–≥—Ä—É–∑–∫–∞ WAV –∏–∑ assets

```dart
import 'package:flutter/services.dart';

Future<Uint8List> loadWavFromAssets(String assetPath) async {
  final byteData = await rootBundle.load(assetPath);
  return byteData.buffer.asUint8List();
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
final audioBytes = await loadWavFromAssets('assets/audio.wav');
// –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª
final tempDir = await getTemporaryDirectory();
final tempFile = File('${tempDir.path}/audio.wav');
await tempFile.writeAsBytes(audioBytes);

// –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º
await cozmo.playAudio(tempFile.path);
```

### –ü—Ä–∏–º–µ—Ä 4: Streaming –∞—É–¥–∏–æ (–æ—á–µ—Ä–µ–¥—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è)

```dart
// –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
await playAudioStreaming('/path/to/audio1.wav');

// –ú–æ–∂–Ω–æ —Å—Ä–∞–∑—É –¥–æ–±–∞–≤–∏—Ç—å –µ—â—ë —Ñ–∞–π–ª—ã - –æ–Ω–∏ –±—É–¥—É—Ç –∏–≥—Ä–∞—Ç—å –ø–æ–¥—Ä—è–¥
await playAudioStreaming('/path/to/audio2.wav');
await playAudioStreaming('/path/to/audio3.wav');

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∫–æ–ª—å–∫–æ –ø–∞–∫–µ—Ç–æ–≤ –≤ –æ—á–µ—Ä–µ–¥–∏
print('–í –æ—á–µ—Ä–µ–¥–∏: $audioQueueLength –ø–∞–∫–µ—Ç–æ–≤');

// –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –æ—á–∏—Å—Ç–∏—Ç—å –æ—á–µ—Ä–µ–¥—å –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ
clearAudioQueue();
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å streaming:**
- ‚úÖ –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
- ‚úÖ –§–æ–Ω–æ–≤–∞—è –º—É–∑—ã–∫–∞ –≤ –∏–≥—Ä–µ
- ‚úÖ TTS (Text-to-Speech) –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –ú–∏–∫—Ä–æ—Ñ–æ–Ω (–µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —Ç—Ä–∞–Ω—Å–ª–∏—Ä–æ–≤–∞—Ç—å –≥–æ–ª–æ—Å)

## üéµ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∞—É–¥–∏–æ —Ñ–∞–π–ª–æ–≤

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ WAV —Ñ–∞–π–ª–∞–º

- **–§–æ—Ä–º–∞—Ç**: WAV (RIFF)
- **–ö–æ–¥–µ–∫**: 16-bit PCM
- **–ß–∞—Å—Ç–æ—Ç–∞ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏**: 22.05 kHz (22050 Hz)
- **–ö–∞–Ω–∞–ª—ã**: Mono (1 –∫–∞–Ω–∞–ª)
- **–ë–∏—Ç–Ω–æ—Å—Ç—å**: 16-bit

### –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —á–µ—Ä–µ–∑ FFmpeg

```bash
# –ò–∑ MP3 –≤ Cozmo —Ñ–æ—Ä–º–∞—Ç
ffmpeg -i input.mp3 -ar 22050 -ac 1 -acodec pcm_s16le output.wav

# –ò–∑ –¥—Ä—É–≥–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
ffmpeg -f lavfi -i "sine=frequency=440:duration=1" -ar 22050 -ac 1 output.wav
```

### –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —á–µ—Ä–µ–∑ Python

```python
from scipy.io import wavfile
import numpy as np

# –ó–∞–≥—Ä—É–∑–∫–∞ –∞—É–¥–∏–æ
rate, data = wavfile.read('input.wav')

# –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ –º–æ–Ω–æ
if len(data.shape) > 1:
    data = data.mean(axis=1)

# –†–µ—Å–µ–º–ø–ª–∏–Ω–≥ –¥–æ 22050 Hz
if rate != 22050:
    from scipy.signal import resample
    data = resample(data, int(len(data) * 22050 / rate))

# –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ 16-bit
data = (data * 32767).astype(np.int16)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
wavfile.write('output.wav', 22050, data)
```

## üîß API Reference

### TopLevel —Ñ—É–Ω–∫—Ü–∏–∏

–û—Å–Ω–æ–≤–Ω–æ–π API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Cozmo. –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ —Å–∏–Ω–≥–ª—Ç–æ–Ω `CozmoClient.instance`.

#### `connect({Duration timeout = const Duration(seconds: 10)})`

–ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Cozmo —Ä–æ–±–æ—Ç—É.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- `null` - –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
- `String` - —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `timeout` - —Ç–∞–π–º–∞—É—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10 —Å–µ–∫—É–Ω–¥)

**–ü—Ä–∏–º–µ—Ä:**
```dart
final error = await connect();
if (error != null) {
  print('–û—à–∏–±–∫–∞: $error');
} else {
  print('–ü–æ–¥–∫–ª—é—á–µ–Ω–æ!');
}
```

---

#### `disconnect()`

–û—Ç–∫–ª—é—á–∞–µ—Ç—Å—è –æ—Ç Cozmo —Ä–æ–±–æ—Ç–∞.

**–ü—Ä–∏–º–µ—Ä:**
```dart
await disconnect();
```

---

#### `playAudio(String wavFilePath, {void Function(double progress)? onProgress})`

–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç WAV —Ñ–∞–π–ª —á–µ—Ä–µ–∑ Cozmo.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `wavFilePath` - –ø—É—Ç—å –∫ WAV —Ñ–∞–π–ª—É
- `onProgress` - callback –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (0.0 - 1.0)

**–ò—Å–∫–ª—é—á–µ–Ω–∏—è:**
- `CozmoException` - –µ—Å–ª–∏ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ –∏–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω

**–ü—Ä–∏–º–µ—Ä:**
```dart
await playAudio(
  '/path/to/audio.wav',
  onProgress: (progress) {
    print('–ü—Ä–æ–≥—Ä–µ—Å—Å: ${(progress * 100).toInt()}%');
  },
);
```

---

#### `setVolume(int volume)`

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≥—Ä–æ–º–∫–æ—Å—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `volume` - –≥—Ä–æ–º–∫–æ—Å—Ç—å –æ—Ç 0 –¥–æ 100 (0-100%)

**–ü—Ä–∏–º–µ—Ä:**
```dart
await setVolume(75); // 75% –≥—Ä–æ–º–∫–æ—Å—Ç–∏
await setVolume(100); // 100% –≥—Ä–æ–º–∫–æ—Å—Ç–∏ (–º–∞–∫—Å–∏–º—É–º)
await setVolume(50); // 50% –≥—Ä–æ–º–∫–æ—Å—Ç–∏
```

---

#### `playAudioStreaming(String wavFilePath)`

–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç WAV —Ñ–∞–π–ª —á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥—å (streaming mode). –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç execution.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–∞–¥ `playAudio()`:**
- –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞
- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –±–æ–ª—å—à–µ –∞—É–¥–∏–æ –ø–æ–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä:**
```dart
// –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
await playAudioStreaming('/path/to/audio1.wav');
// –ú–æ–∂–Ω–æ —Å—Ä–∞–∑—É –¥–æ–±–∞–≤–∏—Ç—å –µ—â—ë —Ñ–∞–π–ª—ã
await playAudioStreaming('/path/to/audio2.wav');
```

---

#### `enqueueAudio(List<Uint8List> packets)`

–î–æ–±–∞–≤–ª—è–µ—Ç –∞—É–¥–∏–æ –ø–∞–∫–µ—Ç—ã –≤ –æ—á–µ—Ä–µ–¥—å –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```dart
// –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∞—É–¥–∏–æ –≤ –ø–∞–∫–µ—Ç—ã –∑–∞—Ä–∞–Ω–µ–µ
final packets = convertAudioToPackets(audioData);

// –î–æ–±–∞–≤–∏—Ç—å –≤ –æ—á–µ—Ä–µ–¥—å –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
enqueueAudio(packets);

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏
print('–í –æ—á–µ—Ä–µ–¥–∏: $audioQueueLength –ø–∞–∫–µ—Ç–æ–≤');
```

---

#### `clearAudioQueue()`

–û—á–∏—â–∞–µ—Ç –æ—á–µ—Ä–µ–¥—å –∞—É–¥–∏–æ –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ.

**–ü—Ä–∏–º–µ—Ä:**
```dart
// –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∏ –æ—á–∏—Å—Ç–∏—Ç—å –æ—á–µ—Ä–µ–¥—å
clearAudioQueue();
```

---

#### `audioQueueLength` ‚Üí int

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â–∏–π —Ä–∞–∑–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏ –∞—É–¥–∏–æ –ø–∞–∫–µ—Ç–æ–≤.

**–ü—Ä–∏–º–µ—Ä:**
```dart
if (audioQueueLength > 0) {
  print('–ê—É–¥–∏–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è, –æ—Å—Ç–∞–ª–æ—Å—å $audioQueueLength –ø–∞–∫–µ—Ç–æ–≤');
}
```

---

#### `setLiftHeight(double height, {double speed, double acceleration})`

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—ã—Å–æ—Ç—É –ø–æ–¥—ä—ë–º–Ω–∏–∫–∞ Cozmo (lift).

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `height` - –≤—ã—Å–æ—Ç–∞ –≤ –º–∏–ª–ª–∏–º–µ—Ç—Ä–∞—Ö (32.0 = –≤–Ω–∏–∑, 92.0 = –≤–≤–µ—Ä—Ö)
- `speed` - —Å–∫–æ—Ä–æ—Å—Ç—å –≤ —Ä–∞–¥/—Å–µ–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 3.0)
- `acceleration` - —É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ —Ä–∞–¥/—Å–µ–∫¬≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20.0)

**–î–∏–∞–ø–∞–∑–æ–Ω:** 32.0 –º–º (–≤–Ω–∏–∑) ‚Üí 92.0 –º–º (–≤–≤–µ—Ä—Ö)

**–ü—Ä–∏–º–µ—Ä:**
```dart
// –ü–æ–¥–Ω—è—Ç—å –ø–æ–¥—ä—ë–º–Ω–∏–∫ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–≤–µ—Ä—Ö
await setLiftHeight(92.0);

// –û–ø—É—Å—Ç–∏—Ç—å –ø–æ–¥—ä—ë–º–Ω–∏–∫ –≤–Ω–∏–∑
await setLiftHeight(32.0);

// –°—Ä–µ–¥–Ω–µ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ
await setLiftHeight(62.0);

// –ú–µ–¥–ª–µ–Ω–Ω–æ –≤–≤–µ—Ä—Ö
await setLiftHeight(92.0, speed: 2.0);
```

---

#### `setHeadAngle(double angle, {double speed, double acceleration})`

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —É–≥–æ–ª –ø–æ–≤–æ—Ä–æ—Ç–∞ –≥–æ–ª–æ–≤—ã Cozmo.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `angle` - —É–≥–æ–ª –≤ —Ä–∞–¥–∏–∞–Ω–∞—Ö (-0.436 = –≤–Ω–∏–∑, 0.0 = –ø—Ä—è–º–æ, 0.777 = –≤–≤–µ—Ä—Ö)
- `speed` - —Å–∫–æ—Ä–æ—Å—Ç—å –≤ —Ä–∞–¥/—Å–µ–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10.0)
- `acceleration` - —É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ —Ä–∞–¥/—Å–µ–∫¬≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10.0)

**–î–∏–∞–ø–∞–∑–æ–Ω:** -25¬∞ (-0.436 —Ä–∞–¥) ‚Üí +44.5¬∞ (0.777 —Ä–∞–¥)

**–ü—Ä–∏–º–µ—Ä:**
```dart
// –ü–æ–¥–Ω—è—Ç—å –≥–æ–ª–æ–≤—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–≤–µ—Ä—Ö
await setHeadAngle(0.777);

// –ì–æ–ª–æ–≤–∞ –ø—Ä—è–º–æ (–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ)
await setHeadAngle(0.0);

// –û–ø—É—Å—Ç–∏—Ç—å –≥–æ–ª–æ–≤—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–Ω–∏–∑
await setHeadAngle(-0.436);

// –ú–µ–¥–ª–µ–Ω–Ω–æ –≤–≤–µ—Ä—Ö
await setHeadAngle(0.5, speed: 5.0);
```

---

#### `playEmotion(CozmoEmotion emotion, {int loops = 1, bool wait = true})`

–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –∞–Ω–∏–º–∞—Ü–∏—é —ç–º–æ—Ü–∏–∏ –Ω–∞ Cozmo.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `emotion` - —ç–º–æ—Ü–∏—è –∏–∑ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è `CozmoEmotion`
- `loops` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1)
- `wait` - –∂–¥–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é true)

**–î–æ—Å—Ç—É–ø–Ω—ã–µ —ç–º–æ—Ü–∏–∏:**
```dart
// –û—Å–Ω–æ–≤–Ω—ã–µ —ç–º–æ—Ü–∏–∏
CozmoEmotion.happy        // –°—á–∞—Å—Ç—å–µ
CozmoEmotion.sad          // –ì—Ä—É—Å—Ç—å
CozmoEmotion.surprised    // –£–¥–∏–≤–ª–µ–Ω–∏–µ
CozmoEmotion.thinking     // –ó–∞–¥—É–º—á–∏–≤–æ—Å—Ç—å
CozmoEmotion.frustrated   // –†–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω–∏–µ/–ó–ª–æ—Å—Ç—å
CozmoEmotion.scared       // –ò—Å–ø—É–≥
CozmoEmotion.sleepy       // –°–æ–Ω–ª–∏–≤–æ—Å—Ç—å

// –î–µ–π—Å—Ç–≤–∏—è –∂–∏–≤–æ—Ç–Ω—ã—Ö
CozmoEmotion.dog          // –°–æ–±–∞–∫–∞
CozmoEmotion.cat          // –ö–æ—à–∫–∞

// –ò–≥—Ä–æ–≤—ã–µ —Ä–µ–∞–∫—Ü–∏–∏
CozmoEmotion.win          // –ü–æ–±–µ–¥–∞
CozmoEmotion.lose         // –ü—Ä–æ–∏–≥—Ä—ã—à

// –û–±—â–µ–Ω–∏–µ
CozmoEmotion.chatty       // –ë–æ–ª—Ç–æ–≤–Ω—è
CozmoEmotion.greeting     // –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
CozmoEmotion.sneeze       // –ß–∏—Ö–∞–Ω–∏–µ
CozmoEmotion.hiccup       // –ò–∫–æ—Ç–∞
```

**–ü—Ä–∏–º–µ—Ä:**
```dart
// –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —ç–º–æ—Ü–∏—é "–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ"
await CozmoClient.instance.playEmotion(CozmoEmotion.greeting);

// –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —ç–º–æ—Ü–∏—é "—Å—á–∞—Å—Ç—å–µ" 2 —Ä–∞–∑–∞
await playEmotion(CozmoEmotion.happy, loops: 2);

// –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –±–µ–∑ –æ–∂–∏–¥–∞–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
await playEmotion(CozmoEmotion.thinking, wait: false);
// –ú–æ–∂–Ω–æ —Å—Ä–∞–∑—É –¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–µ...

// –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenAI Realtime
// –í –æ—Ç–≤–µ—Ç–µ –Ω–∞ —Å–æ–±—ã—Ç–∏–µ:
if (responseText.contains('–≤–∞—É')) {
  await playEmotion(CozmoEmotion.surprised);
}
```

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–º–∞–Ω–¥—É `PlayAnimationTrigger` (0x26)
- ID —ç–º–æ—Ü–∏–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç Code Lab Triggers –∏–∑ pycozmo
- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ ~1-2 —Å–µ–∫—É–Ω–¥—ã
- –ü—Ä–∏ `wait=true` –º–µ—Ç–æ–¥ –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏

---

#### `playAnimation(CozmoAnimation animation, {int loops = 1})`

–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –∞–Ω–∏–º–∞—Ü–∏—é –Ω–∞ Cozmo –ø–æ –∏–º–µ–Ω–∏ –∏–∑ enum `CozmoAnimation`.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `animation` - –∞–Ω–∏–º–∞—Ü–∏—è –∏–∑ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è `CozmoAnimation`
- `loops` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1)

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ (50+):**
```dart
// === –ü—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ –∏ —Å–æ–Ω ===
CozmoAnimation.wakeUp        // anim_launch_wakeup_01
CozmoAnimation.sleep         // anim_sleeping_01
CozmoAnimation.yawn          // anim_yawn_01

// === –°—á–∞—Å—Ç—å–µ –∏ —Ä–∞–¥–æ—Å—Ç—å ===
CozmoAnimation.happyPounce   // anim_happy_pounce_01
CozmoAnimation.happyYes      // anim_happy_yes_01
CozmoAnimation.excited       // anim_excited_01
CozmoAnimation.majorWin      // anim_majorwin_01
CozmoAnimation.celebrate     // anim_celebrate_01

// === –ì—Ä—É—Å—Ç—å ===
CozmoAnimation.sadReactions  // anim_sad_reactions_01
CozmoAnimation.crying        // anim_crying_01
CozmoAnimation.frustrated    // anim_frustrated_01

// === –£–¥–∏–≤–ª–µ–Ω–∏–µ ===
CozmoAnimation.surprised     // anim_surprised_01
CozmoAnimation.what          // anim_what_01

// === –î—É–º–∞–µ—Ç ===
CozmoAnimation.thinking      // anim_thinking_01
CozmoAnimation.processing    // anim_processing_01
CozmoAnimation.confused      // anim_confused_01

// === –°—Ç—Ä–∞—Ö ===
CozmoAnimation.scared        // anim_scared_01
CozmoAnimation.startled      // anim_startled_01
CozmoAnimation.flee          // anim_flee_01

// === –¢–∞–Ω—Ü—ã –∏ –≤–µ—Å–µ–ª—å–µ ===
CozmoAnimation.dance         // anim_dance_01
CozmoAnimation.danceSprint   // anim_dance_sprint_01
CozmoAnimation.moonwalk      // anim_moonwalk_01
CozmoAnimation.burp          // anim_burp_01
CozmoAnimation.sneeze        // anim_sneeze_01
CozmoAnimation.hiccup        // anim_hiccup_01

// === –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–µ–∞–∫—Ü–∏–∏ ===
CozmoAnimation.greeting      // anim_greeting_01
CozmoAnimation.sayName       // anim_sayname_01
CozmoAnimation.yes           // anim_yes_01
CozmoAnimation.no            // anim_no_01
CozmoAnimation.love          // anim_love_01
CozmoAnimation.like          // anim_like_01
CozmoAnimation.dislike       // anim_dislike_01
CozmoAnimation.bored         // anim_bored_01

// === –ò–≥—Ä—ã ===
CozmoAnimation.game_win      // anim_gamewin_01
CozmoAnimation.game_lose     // anim_gamelose_01
CozmoAnimation.scoreGoal     // anim_scoregoal_01

// === –î–≤–∏–∂–µ–Ω–∏—è ===
CozmoAnimation.rollOver      // anim_rollover_01
CozmoAnimation.shake         // anim_shake_01
CozmoAnimation.backup        // anim_backup_01
CozmoAnimation.turnLeft      // anim_turn_left_01
CozmoAnimation.turnRight     // anim_turn_right_01

// === –î–µ–π—Å—Ç–≤–∏—è ===
CozmoAnimation.seeCharger    // anim_seecharger_01
CozmoAnimation.onCharger     // anim_oncharger_01
CozmoAnimation.pickupCube    // anim_pickupcube_01
CozmoAnimation.placeCube     // anim_placecube_01

// === –ö—É–±—ã ===
CozmoAnimation.cubePounce    // anim_cubepounce_01
CozmoAnimation.cubeWhack     // anim_cubewhack_01

// === –õ–∏—Ü–æ ===
CozmoAnimation.faceAngry     // anim_face_angry_01
CozmoAnimation.faceSad       // anim_face_sad_01
CozmoAnimation.faceSurprised // anim_face_surprised_01

// === –°–∫–æ—Ä–æ—Å—Ç—å ===
CozmoAnimation.speedLines    // anim_speedlines_01
CozmoAnimation.dizzy         // anim_dizzy_01

// === –†–∞–∑–Ω–æ–µ ===
CozmoAnimation.knockOver     // anim_knockover_01
CozmoAnimation.getUp         // anim_getup_01
CozmoAnimation.fail          // anim_fail_01
CozmoAnimation.look          // anim_look_01
```

**–ü—Ä–∏–º–µ—Ä:**
```dart
// –¢–∞–Ω–µ—Ü
await CozmoClient.instance.playAnimation(CozmoAnimation.dance);

// –° –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ–º
await playAnimation(CozmoAnimation.celebrate, loops: 2);

// –ö–æ–º–±–∏–Ω–∞—Ü–∏—è —ç–º–æ—Ü–∏–π –∏ –∞–Ω–∏–º–∞—Ü–∏–π
await playEmotion(CozmoEmotion.happy);
await playAnimation(CozmoAnimation.dance);

// –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–π
await playAnimation(CozmoAnimation.wakeUp);
await Future.delayed(Duration(seconds: 1));
await playAnimation(CozmoAnimation.yes);
await Future.delayed(Duration(seconds: 1));
await playAnimation(CozmoAnimation.celebrate);
```

---

#### `playAnimationByName(String animName, {int loops = 1})`

–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –∞–Ω–∏–º–∞—Ü–∏—é –ø–æ –∏–º–µ–Ω–∏ (—Å—Ç—Ä–æ–∫–∞). –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ `CozmoAnimation` enum.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `animName` - –∏–º—è –∞–Ω–∏–º–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä "anim_dance_01")
- `loops` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1)

**–ü—Ä–∏–º–µ—Ä:**
```dart
// –ü–æ –∏–º–µ–Ω–∏ –∞–Ω–∏–º–∞—Ü–∏–∏
await playAnimationByName("anim_speedlines_01");

// –° –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ–º
await playAnimationByName("anim_celebrate_01", loops: 3);

// –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª—é–±—ã–µ –∏–º–µ–Ω–∞ –∞–Ω–∏–º–∞—Ü–∏–π –∏–∑ pycozmo
await playAnimationByName("anim_launch_wakeup_01");
```

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Å–ª—è–µ—Ç Trigger ID —á–µ—Ä–µ–∑ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º–µ–Ω–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–º–∞–Ω–¥—É `PlayAnimationTrigger` (0x26)
- –ò–º–µ–Ω–∞ –∞–Ω–∏–º–∞—Ü–∏–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç pycozmo animation names
- –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ pycozmo —Å–∫—Ä–∏–ø—Ç `list_animations.py`

---

### CozmoClient –∫–ª–∞—Å—Å

–°–∏–Ω–≥–ª—Ç–æ–Ω –∫–ª–∞—Å—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Cozmo —Ä–æ–±–æ—Ç–æ–º. –û–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ topLevel —Ñ—É–Ω–∫—Ü–∏–∏, –Ω–æ –º–æ–∂–Ω–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –Ω–∞–ø—Ä—è–º—É—é.

#### –°–≤–æ–π—Å—Ç–≤–∞

##### `CozmoClient.instance` ‚Üí CozmoClient

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä —Å–∏–Ω–≥–ª—Ç–æ–Ω–∞.

**–ü—Ä–∏–º–µ—Ä:**
```dart
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
if (CozmoClient.instance.isConnected) {
  print('–ü–æ–¥–∫–ª—é—á–µ–Ω–æ!');
}
```

##### `isConnected` ‚Üí bool

–°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Cozmo.

**–ü—Ä–∏–º–µ—Ä:**
```dart
if (CozmoClient.instance.isConnected) {
  print('–ü–æ–¥–∫–ª—é—á–µ–Ω–æ!');
}
```

## üìã –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

### 1. –í–∫–ª—é—á–∏—Ç–µ Cozmo

–ü–æ—Å—Ç–∞–≤—å—Ç–µ Cozmo –Ω–∞ –∑–∞—Ä—è–¥–Ω—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –∏ –≤–∫–ª—é—á–∏—Ç–µ.

### 2. –ü–æ–ª—É—á–∏—Ç–µ Wi-Fi –ø–∞—Ä–æ–ª—å

1. –ü–æ–∫–∞—á–∞–π—Ç–µ –ø–æ–¥—ä—ë–º–Ω–∏–∫ –≤–≤–µ—Ä—Ö-–≤–Ω–∏–∑ 3 —Ä–∞–∑–∞
2. –ö–æzmo –ø—Ä–æ–∏–∑–Ω–µ—Å—ë—Ç –ø–∞—Ä–æ–ª—å (12 —Å–∏–º–≤–æ–ª–æ–≤)
3. –ò–õ–ò –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–æ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `aaaaaaaaaaaa`

### 3. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∫ Cozmo Wi-Fi

**macOS:**
1. System Settings ‚Üí Network ‚Üí Wi-Fi
2. –í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Ç—å `Cozmo_XXXXXX`
3. –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å

**iOS/Android:**
1. Settings ‚Üí Wi-Fi
2. –í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Ç—å `Cozmo_XXXXXX`
3. –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å

### 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Flutter –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
flutter run
```

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Cozmo

**–†–µ—à–µ–Ω–∏—è:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ Wi-Fi `Cozmo_XXXXXX`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Cozmo –≤–∫–ª—é—á–µ–Ω –∏ –Ω–∞ –∑–∞—Ä—è–¥–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ
3. –ù–∏–∫—Ç–æ –¥—Ä—É–≥–æ–π –Ω–µ –ø–æ–¥–∫–ª—é—á—ë–Ω –∫ Cozmo
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

### –ü—Ä–æ–±–ª–µ–º–∞: –ê—É–¥–∏–æ –Ω–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è

**–†–µ—à–µ–Ω–∏—è:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç WAV —Ñ–∞–π–ª–∞:
   ```bash
   file audio.wav
   # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: "RIFF (little-endian) data, WAVE audio, Microsoft PCM, 16 bit, mono 22050 Hz"
   ```
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥—Ä–æ–º–∫–æ—Å—Ç—å (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å > 0)

### –ü—Ä–æ–±–ª–µ–º–∞: –ó–≤—É–∫ –ø—Ä–µ—Ä—ã–≤–∏—Å—Ç—ã–π

**–†–µ—à–µ–Ω–∏—è:**
1. ‚úÖ **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—á–Ω—ã–π —Ç–∞–π–º–∏–Ω–≥** - —à–ª–∏—Ç–µ –ø–∞–∫–µ—Ç—ã –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ!
2. ‚úÖ **–¢–æ–ª—å–∫–æ backpressure** - –∂–¥–∏—Ç–µ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ—á–µ—Ä–µ–¥—å > 100
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–∏–≥–Ω–∞–ª Wi-Fi —Ö–æ—Ä–æ—à–∏–π
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π WAV —Ñ–∞–π–ª

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ü–†–ê–í–ò–õ–û (–∏–∑—É—á–µ–Ω–æ –∏–∑ pycozmo):**

PyCozmo –ù–ï –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —Ç–∞–π–º–∏–Ω–≥ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è! –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ:

```python
# –ü–†–ê–í–ò–õ–¨–ù–û (–∫–∞–∫ pycozmo conn.py):
class SendThread(Thread):
    COLLECT_INTERVAL = 1/30 / 3  # ~11 –º—Å - —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–±–æ—Ä–∞ –ø–∞–∫–µ—Ç–æ–≤

    def send(self, data):
        self.queue.put(data)  # –ü—Ä–æ—Å—Ç–æ –∫–ª–∞–¥–µ–º –≤ –æ—á–µ—Ä–µ–¥—å –ë–ï–ó –∑–∞–¥–µ—Ä–∂–µ–∫!
```

**‚ùå –ù–ï –î–ï–õ–ê–ô–¢–ï (–Ω–∞—à–∞ –æ—à–∏–±–∫–∞):**
```dart
// –ü–õ–û–•–û - –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–∞–¥–µ—Ä–∂–∏–≤–∞–Ω–∏–µ
final targetTime = startTime + ((i + 1) * packetDurationUs);
await Future.delayed(Duration(microseconds: targetTime - now));
// –≠—Ç–æ —Å–æ–∑–¥–∞–µ—Ç –±—É—Ç—ã–ª–æ—á–Ω–æ–µ –≥–æ—Ä–ª—ã—à–∫–æ –≤ Dart!
```

**‚úÖ –î–ï–õ–ê–ô–¢–ï (–∫–∞–∫ pycozmo):**
```dart
// –•–û–†–û–®–û - —à–ª–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ
for (int i = 0; i < packets.length; i++) {
    // –¢–æ–ª—å–∫–æ backpressure —Ç–æ—Ä–º–æ–∑–∏—Ç –Ω–∞—Å
    while (_client.outboundQueueLength > 100) {
        await Future.delayed(const Duration(milliseconds: 1));
    }
    _client.sendRawPacket(packets[i]);  // –®–ª–µ–º —Å—Ä–∞–∑—É!
}
```

**–ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –ü–∞–∫–µ—Ç—ã –∫–ª–∞–¥—É—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å **–∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ**
2. SendThread (5ms ticker) —Å–æ–±–∏—Ä–∞–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –ø–æ UDP
3. –†–æ–±–æ—Ç —Å–∞–º –±—É—Ñ–µ—Ä–∏–∑–∏—Ä—É–µ—Ç –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç —Å –Ω—É–∂–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é
4. –ù–∏–∫–∞–∫–æ–≥–æ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–∞–¥–µ—Ä–∂–∏–≤–∞–Ω–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è!

## üìù –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ø—Ä–æ—Ç–æ–∫–æ–ª–∞

```dart
const String COZMO_IP = '172.31.1.1';        // IP –∞–¥—Ä–µ—Å Cozmo
const int COZMO_PORT = 5551;                   // UDP –ø–æ—Ä—Ç
const int COZMO_SAMPLE_RATE = 22050;           // –ß–∞—Å—Ç–æ—Ç–∞ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏
const int AUDIO_PACKET_SAMPLES = 744;          // –°—ç–º–ø–ª–æ–≤ –≤ –ø–∞–∫–µ—Ç–µ
```

## üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–†–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞**: 744 —Å—ç–º–ø–ª–æ–≤ (744 –±–∞–π—Ç–∞ u-law)
- **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–∞–∫–µ—Ç–∞**: ~33.7 –º—Å
- **–ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–∞–∫–µ—Ç–∞–º–∏**: 33.7 –º—Å
- **–°–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏**: ~22 KB/—Å–µ–∫

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–¢–æ–ª—å–∫–æ iOS/macOS/Android** - Desktop –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è (–Ω–µ—Ç UDP —Å–æ–∫–µ—Ç–æ–≤)
2. **–¢–æ–ª—å–∫–æ Wi-Fi —Å–µ—Ç—å Cozmo** - —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ Cozmo_XXXXXX
3. **–û–¥–∏–Ω –∫–ª–∏–µ–Ω—Ç** - —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Cozmo –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

## üî¨ –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### ‚ö° AnimationController –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –∞—É–¥–∏–æ/—ç–∫—Ä–∞–Ω–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** AnimController —à–ª–µ—Ç OutputSilence –∫–∞–∂–¥—ã–µ 33–º—Å, —á—Ç–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç —Å –∞—É–¥–∏–æ –ø–∞–∫–µ—Ç–∞–º–∏.

**–†–µ—à–µ–Ω–∏–µ –æ—Ç pycozmo:** "Audio Takeover" pattern

```dart
class CozmoAnimController {
  bool _isAudioBusy = false;

  void _tick() {
    // 1. –ê–£–î–ò–û / –¢–ò–®–ò–ù–ê
    // –ï—Å–ª–∏ –∞—É–¥–∏–æ –∑–∞–Ω—è—Ç–æ - –ú–´ –ú–û–õ–ß–ò–ú (–Ω–µ —à–ª–µ–º OutputSilence)
    if (!_isAudioBusy) {
      _client.sendCommand(CozmoCmd.outputSilence, []);
    }

    // 2. –≠–ö–†–ê–ù (–æ–±–Ω–æ–≤–ª—è–µ–º –¥–∞–∂–µ –≤–æ –≤—Ä–µ–º—è –∞—É–¥–∏–æ!)
    if (_tickCounter % 30 == 0 && _currentImagePayload != null) {
      _client.sendCommand(CozmoCmd.displayImage, _currentImagePayload!);
    }

    _tickCounter++;
  }

  void setAudioBusy(bool busy) {
    _isAudioBusy = busy;  // –ê—É–¥–∏–æ –º–æ–¥—É–ª—å —É–ø—Ä–∞–≤–ª—è–µ—Ç —ç—Ç–∏–º —Ñ–ª–∞–≥–æ–º
  }
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∞—É–¥–∏–æ:**
```dart
Future<void> _streamPackets(List<List<int>> packets) async {
  // 1. –ó–ê–•–í–ê–¢–´–í–ê–ï–ú –ö–û–ù–¢–†–û–õ–¨
  _animController.setAudioBusy(true);  // –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –∑–∞–º–æ–ª–∫–∞–µ—Ç

  try {
    // 2. –ë–´–°–¢–†–ê–Ø –û–¢–ü–†–ê–í–ö–ê (–±–µ–∑ —Ç–∞–π–º–∏–Ω–≥–∞!)
    for (int i = 0; i < packets.length; i++) {
      while (_client.outboundQueueLength > 100) {
        await Future.delayed(const Duration(milliseconds: 1));
      }
      _client.sendRawPacket(packets[i]);
    }

    // 3. –ñ–¥–µ–º –ø–æ–∫–∞ –æ—á–µ—Ä–µ–¥—å –æ–ø—É—Å—Ç–µ–µ—Ç
    while (_client.outboundQueueLength > 0) {
      await Future.delayed(const Duration(milliseconds: 50));
    }
  } finally {
    // 4. –í–û–ó–í–†–ê–©–ê–ï–ú –ö–û–ù–¢–†–û–õ–¨
    _animController.setAudioBusy(false);  // –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Å–Ω–æ–≤–∞ —à–ª–µ—Ç silence
  }
}
```

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**
1. ‚úÖ **Fast sending** - –ø–∞–∫–µ—Ç—ã —à–ª—é—Ç—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ
2. ‚úÖ **No app-level timing** - —Ç–∞–π–º–∏–Ω–≥ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è —Å–µ—Ç–µ–≤—ã–º —Å–ª–æ–µ–º
3. ‚úÖ **Audio takeover** - –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –∑–∞–º–æ–ª–∫–∞–µ—Ç –≤–æ –≤—Ä–µ–º—è –∞—É–¥–∏–æ
4. ‚úÖ **Screen stays on** - DisplayImage –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –¥–∞–∂–µ –≤–æ –≤—Ä–µ–º—è –∞—É–¥–∏–æ
5. ‚úÖ **Backpressure only** - –∂–¥–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ—á–µ—Ä–µ–¥—å –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∞

### –ü—Ä–æ—Ç–æ–∫–æ–ª

- **–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç**: UDP
- **–§—Ä–µ–π–º–∏–Ω–≥**: Custom binary protocol (–æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ pycozmo)
- **–ê—É–¥–∏–æ –∫–æ–¥–µ–∫**: u-law (8-bit compressed)
- **–ü–∞–∫–µ—Ç—ã**: 744 —Å—ç–º–ø–ª–æ–≤ –Ω–∞ –ø–∞–∫–µ—Ç @ 22.05kHz

### üñºÔ∏è DisplayImage - –í—ã–≤–æ–¥ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ —ç–∫—Ä–∞–Ω

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ:** OutputSilence (0x8f) –¥–æ–ª–∂–µ–Ω –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è **–î–û** DisplayImage!

```dart
// ‚ùå –ü–õ–û–•–û - –±–µ–∑ OutputSilence
_client.sendCommand(CozmoCmd.displayImage, payload);
// –ú–æ–∂–µ—Ç –Ω–µ –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å –∏–ª–∏ –æ–±–æ—Ä–≤–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

// ‚úÖ –•–û–†–û–®–û - —Å OutputSilence
_client.sendCommand(CozmoCmd.outputSilence, []);
await Future.delayed(const Duration(milliseconds: 1));
_client.sendCommand(CozmoCmd.displayImage, payload);
```

**–§–æ—Ä–º–∞—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:**
- –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ: 128x32 –ø–∏–∫—Å–µ–ª—è
- –¶–≤–µ—Ç–∞: 1-bit (—á–µ—Ä–Ω—ã–π/–±–µ–ª—ã–π)
- –ö–æ–º–ø—Ä–µ—Å—Å–∏—è: RLE (Run-Length Encoding)
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞: [Flags=3, ImgID=1, ChunkID=0, RLE Data...]

**RLE –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ (column-based):**
```
Skip (0x00-0x3F): –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å X+1 –ø—É—Å—Ç—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
Repeat (0x40-0x7F): –ü–æ–≤—Ç–æ—Ä–∏—Ç—å X+1 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
Draw (0x80/0xC0): –ù–∞—Ä–∏—Å–æ–≤–∞—Ç—å —Å—Ç–æ–ª–±–µ—Ü —Å RLE –ø–∏–∫—Å–µ–ª–µ–π
```

**–ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –≥–ª–∞–∑:**
```dart
final img = CozmoSimpleImage.createEyes();
// –õ–µ–≤—ã–π –≥–ª–∞–∑ (35-55, 8-16)
img.drawRect(35, 8, 55, 16);
// –ü—Ä–∞–≤—ã–π –≥–ª–∞–∑ (73-93, 8-16)
img.drawRect(73, 8, 93, 16);
// –£–ª—ã–±–∫–∞ (–ª–∏–Ω–∏—è –æ—Ç 40 –¥–æ 88 –Ω–∞ y=24)
for (int x = 40; x <= 88; x++) {
  img.pixels[24 * 128 + x] = 255;
}

robot.displayImage(img);
```

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –≠–∫—Ä–∞–Ω –≥–∞—Å–Ω–µ—Ç —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥ –±–µ–∑ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- AnimController –¥–æ–ª–∂–µ–Ω –æ–±–Ω–æ–≤–ª—è—Ç—å —ç–∫—Ä–∞–Ω —Ä–∞–∑ –≤ —Å–µ–∫—É–Ω–¥—É
- –°–ª–æ–∂–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (>79 bytes) –º–æ–≥—É—Ç –≤—ã–∑—ã–≤–∞—Ç—å –±–∞–≥–∏ RLE
- Repeat —Ñ—É–Ω–∫—Ü–∏—é –ª—É—á—à–µ –æ—Ç–∫–ª—é—á–∏—Ç—å –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏

### Frame Format

```
[FRAME_ID: 7 bytes][Type: 1][FirstSeq: 2][Seq: 2][Ack: 2][Packets...]
```

### Audio Packet Format

```
[Type: 1][Length: 2][CmdID: 1][Samples: 744]
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É:

- **[PROTOCOL_REFERENCE.md](PROTOCOL_REFERENCE.md)** ‚Äî –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ Cozmo
  - FrameType –∏ PacketType enum'—ã
  - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥ –∏ —Å–æ–±—ã—Ç–∏–π
  - u-law –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—É–¥–∏–æ
  - –ü—Ä–∏–º–µ—Ä—ã –ø–∞–∫–µ—Ç–æ–≤ –≤ hex
  - –ê–Ω–∞–ª–∏–∑ pycozmo –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤

- **[QUICK_REFERENCE.md](QUICK_REFERENCE.md)** ‚Äî –±—ã—Å—Ç—Ä–∞—è —à–ø–∞—Ä–≥–∞–ª–∫–∞
  - –í—Å–µ Frame Types –∏ Packet Types
  - –ö–∞—Ä—Ç–∞ –≤–∞–∂–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ (Enable, SetHeadAngle, OutputAudio, etc.)
  - RobotState —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–±—ã—Ç–∏—è
  - –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Ä–æ–±–æ—Ç–∞
  - –ü—Ä–∏–º–µ—Ä—ã –ø–∞–∫–µ—Ç–æ–≤ –≤ hex

- **[RECEIVE_LOOP_IMPLEMENTATION.md](RECEIVE_LOOP_IMPLEMENTATION.md)** ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è receive loop
  - –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–∏-directional –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è
  - –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ UDP –ø—Ä–∏—ë–º–∞
  - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

- **[CHANGELOG.md](CHANGELOG.md)** ‚Äî –∏—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π
  - v1.2.0 ‚Äî ROBOT frame support
  - v1.1.0 ‚Äî Bi-directional communication
  - v1.0.0 ‚Äî –ü–µ—Ä–≤—ã–π —Ä–µ–ª–∏–∑

### External —Å—Å—ã–ª–∫–∏:

- **pycozmo**: https://github.com/zayfod/pycozmo
- **Cozmo SDK**: https://github.com/anki/cozmo-python-sdk
- **u-law encoding**: https://en.wikipedia.org/wiki/%CE%9C-law_algorithm

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –∫–æ–¥ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ Cozmo –∏ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–≤–æ–±–æ–¥–Ω–æ.
