# –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ EyeAnimationController

## üéØ –¶–µ–ª—å

–°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å `EyeAnimationController` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏—è–º–∏ –≥–ª–∞–∑ —Ä–æ–±–æ—Ç–∞ Cozmo, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º.

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. **–¢–∏–ø—ã –∞–Ω–∏–º–∞—Ü–∏–π**:
   - –û–∂–∏–¥–∞–Ω–∏–µ (–ø–ª–∞–≤–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –≥–ª–∞–∑)
   - –ú–æ—Ä–≥–∞–Ω–∏–µ (–æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ–µ –∏ —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–µ)
   - –°–æ–Ω (–ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –≥–ª–∞–∑)
   - –ü—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ (–ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –≥–ª–∞–∑)
   - –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è

2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è**:
   - –ó–∞–ø—É—Å–∫–∞—Ç—å—Å—è –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ —Ä–æ–±–æ—Ç—É
   - –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏

3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π**:
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `CozmoFace` –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `CozmoAnimController` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `CozmoClient` –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–º–∞–Ω–¥

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**:
   - –ê–Ω–∏–º–∞—Ü–∏–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Timer –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏
   - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ç—å

2. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**:
   - –†–∞–±–æ—Ç–∞—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ `CozmoRobot` –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
   - –ù–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å –∞—É–¥–∏–æ-—Å–∏—Å—Ç–µ–º–æ–π
   - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–∫—É –∏ –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

3. **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å**:
   - –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –∞–Ω–∏–º–∞—Ü–∏–π
   - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –∞–º–ø–ª–∏—Ç—É–¥–∞)
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–æ–ª–±—ç–∫–æ–≤

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–ª–∞—Å—Å–∞

```dart
library cozmo_eye_animation_controller;

import 'dart:async';
import 'dart:math';
import 'cozmo_client.dart';
import 'cozmo_face.dart';
import 'cozmo_anim_controller.dart';
import 'cozmo_robot.dart';

enum EyeAnimationType {
  none,
  blink,
  blinkLoop,
  wander,
  sleep,
  wakeup,
  happy,
  sad,
  surprised,
  thinking,
}

class EyeAnimationController {
  final CozmoClient _client;
  final CozmoFace _face;
  final CozmoAnimController _animController;
  
  EyeAnimationType _currentAnimation = EyeAnimationType.none;
  Timer? _animationTimer;
  
  // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–Ω–∏–º–∞—Ü–∏–∏
  Duration _blinkInterval = Duration(seconds: 4);
  Duration _wanderInterval = Duration(milliseconds: 2000);
  double _wanderAmplitude = 0.05;
  
  // –°–æ—Å—Ç–æ—è–Ω–∏–µ
  bool _isActive = false;
  
  EyeAnimationController(this._client, this._face, this._animController);
  
  // –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã
  void activate();
  void deactivate();
  void startAnimation(EyeAnimationType type);
  void stopAnimation();
  
  // –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –∞–Ω–∏–º–∞—Ü–∏–∏
  void blink();
  void startBlinkLoop({Duration? interval});
  void stopBlinkLoop();
  void startWandering({Duration? interval});
  void stopWandering();
  void startSleep();
  void startWakeup();
  
  // –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏
  void setHappy();
  void setSad();
  void setSurprised();
  void setThinking();
  
  // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  void setBlinkInterval(Duration interval);
  void setWanderInterval(Duration interval);
  void setWanderAmplitude(double amplitude);
  
  // –ì–µ—Ç—Ç–µ—Ä—ã
  bool get isActive => _isActive;
  EyeAnimationType get currentAnimation => _currentAnimation;
}
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CozmoRobot

```dart
// –í cozmo_robot.dart
class CozmoRobot {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
  late final EyeAnimationController eyeController;
  
  CozmoRobot._internal() {
    // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ EyeAnimationController
    eyeController = EyeAnimationController(_client, _face, _animController);
  }
  
  Future<String?> connect() async {
    final res = await _client.connect();
    
    if (res == null) {
      // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
      
      // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ –≥–ª–∞–∑
      print('üëÄ Starting eye animation controller...');
      eyeController.activate();
    }
    return res;
  }
  
  void disconnect() {
    // –î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –≥–ª–∞–∑
    eyeController.deactivate();
    
    // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
    animController.stop();
    _client.disconnect();
  }
  
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã
}
```

## üß© –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –ê–Ω–∏–º–∞—Ü–∏—è –æ–∂–∏–¥–∞–Ω–∏—è (wandering)

```dart
void _startWandering() {
  if (_currentAnimation == EyeAnimationType.wander) return;
  
  _currentAnimation = EyeAnimationType.wander;
  double wanderPhase = 0.0;
  
  _animationTimer = Timer.periodic(_wanderInterval, (timer) {
    if (!_isActive) return;
    
    wanderPhase += 0.1;
    
    // –ì–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –≥–ª–∞–∑
    double leftX = 0.35 + _wanderAmplitude * sin(wanderPhase);
    double rightX = 0.65 + _wanderAmplitude * sin(wanderPhase + pi);
    
    // –ù–µ–±–æ–ª—å—à–∏–µ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è
    double leftY = 0.5 + 0.02 * cos(wanderPhase * 2);
    double rightY = 0.5 + 0.02 * cos(wanderPhase * 2);
    
    _face._leftEyeX = leftX;
    _face._leftEyeY = leftY;
    _face._rightEyeX = rightX;
    _face._rightEyeY = rightY;
    
    _updateFace();
  });
}
```

### 2. –ê–Ω–∏–º–∞—Ü–∏—è –º–æ—Ä–≥–∞–Ω–∏—è

```dart
void blink() {
  if (_currentAnimation != EyeAnimationType.none) return;
  
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â—É—é –∞–Ω–∏–º–∞—Ü–∏—é
  final previousAnimation = _currentAnimation;
  _currentAnimation = EyeAnimationType.blink;
  
  // –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤–µ–∫–∏
  _face._leftEyelid = 1.0;
  _face._rightEyelid = 1.0;
  _updateFace();
  
  // –û—Ç–∫—Ä—ã–≤–∞–µ–º –≤–µ–∫–∏ —á–µ—Ä–µ–∑ 150–º—Å
  _animationTimer = Timer(Duration(milliseconds: 150), () {
    _face._leftEyelid = 0.0;
    _face._rightEyelid = 0.0;
    _updateFace();
    
    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â—É—é –∞–Ω–∏–º–∞—Ü–∏—é
    _currentAnimation = previousAnimation;
    
    // –ï—Å–ª–∏ –±—ã–ª–∞ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∞—è –∞–Ω–∏–º–∞—Ü–∏—è, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –µ–µ
    if (previousAnimation == EyeAnimationType.blinkLoop) {
      _startBlinkLoop();
    }
  });
}
```

### 3. –ê–Ω–∏–º–∞—Ü–∏—è —Å–Ω–∞

```dart
void startSleep() {
  if (_currentAnimation == EyeAnimationType.sleep) return;
  
  _currentAnimation = EyeAnimationType.sleep;
  double lidProgress = 0.0;
  
  _animationTimer = Timer.periodic(Duration(milliseconds: 50), (timer) {
    if (!_isActive) return;
    
    lidProgress += 0.025; // 25% –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∫–∞–∂–¥—ã–µ 50–º—Å
    
    if (lidProgress >= 1.0) {
      lidProgress = 1.0;
      _animationTimer?.cancel();
      _currentAnimation = EyeAnimationType.none;
    }
    
    _face._leftEyelid = lidProgress;
    _face._rightEyelid = lidProgress;
    
    // –£–º–µ–Ω—å—à–∞–µ–º –≥–ª–∞–∑–∞ –ø—Ä–∏ –∑–∞—Å—ã–ø–∞–Ω–∏–∏
    _face._leftEyeSize = 0.25 * (1.0 - lidProgress * 0.3);
    _face._rightEyeSize = 0.25 * (1.0 - lidProgress * 0.3);
    
    _updateFace();
  });
}
```

## üéÆ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å FlutterFlow

### –ö–∞—Å—Ç–æ–º–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

1. **–ú–æ—Ä–≥–∞–Ω–∏–µ –≥–ª–∞–∑**
```dart
// lib/custom_code/actions/robot_eye_blink.dart
Future robotEyeBlink() async {
  final robot = CozmoRobot.instance;
  
  if (!robot.isConnected) {
    throw Exception('Robot not connected');
  }
  
  robot.eyeController.blink();
}
```

2. **–¶–∏–∫–ª–∏—á–µ—Å–∫–æ–µ –º–æ—Ä–≥–∞–Ω–∏–µ**
```dart
// lib/custom_code/actions/robot_eye_blink_loop.dart
Future robotEyeBlinkLoop({bool enable = true}) async {
  final robot = CozmoRobot.instance;
  
  if (!robot.isConnected) {
    throw Exception('Robot not connected');
  }
  
  if (enable) {
    robot.eyeController.startBlinkLoop();
  } else {
    robot.eyeController.stopBlinkLoop();
  }
}
```

3. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —ç–º–æ—Ü–∏–∏**
```dart
// lib/custom_code/actions/robot_eye_emotion.dart
Future robotEyeEmotion(String emotion) async {
  final robot = CozmoRobot.instance;
  
  if (!robot.isConnected) {
    throw Exception('Robot not connected');
  }
  
  switch (emotion.toLowerCase()) {
    case 'happy':
      robot.eyeController.setHappy();
      break;
    case 'sad':
      robot.eyeController.setSad();
      break;
    case 'surprised':
      robot.eyeController.setSurprised();
      break;
    case 'thinking':
      robot.eyeController.setThinking();
      break;
    default:
      robot.eyeController.stopAnimation();
  }
}
```

### UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```dart
// EyeControlWidget –¥–ª—è FlutterFlow
class EyeControlWidget extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Container(
      decoration: BoxDecoration(
        color: FlutterFlowTheme.of(context).alternate,
        borderRadius: BorderRadius.circular(12.0),
      ),
      child: Padding(
        padding: EdgeInsets.all(12.0),
        child: Column(
          children: [
            Text('–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–ª–∞–∑–∞–º–∏'),
            
            // –ö–Ω–æ–ø–∫–∏ –∞–Ω–∏–º–∞—Ü–∏–π
            Row(
              mainAxisAlignment: MainAxisAlignment.spaceEvenly,
              children: [
                FFButtonWidget(
                  onPressed: () async {
                    await actions.robotEyeBlink();
                  },
                  text: '–ú–æ—Ä–≥–Ω—É—Ç—å',
                ),
                FFButtonWidget(
                  onPressed: () async {
                    await actions.robotEyeEmotion('happy');
                  },
                  text: '–°—á–∞—Å—Ç–ª–∏–≤—ã–µ',
                ),
                FFButtonWidget(
                  onPressed: () async {
                    await actions.robotEyeEmotion('thinking');
                  },
                  text: '–î—É–º–∞—é—â–∏–µ',
                ),
              ],
            ),
            
            // –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–≥–æ –º–æ—Ä–≥–∞–Ω–∏—è
            Row(
              mainAxisAlignment: MainAxisAlignment.spaceBetween,
              children: [
                Text('–¶–∏–∫–ª–∏—á–µ—Å–∫–æ–µ –º–æ—Ä–≥–∞–Ω–∏–µ:'),
                Switch(
                  value: FFAppState().eyeBlinkLoop,
                  onChanged: (value) async {
                    FFAppState().eyeBlinkLoop = value;
                    await actions.robotEyeBlinkLoop(enable: value);
                  },
                ),
              ],
            ),
          ].divide(SizedBox(height: 8.0)),
        ),
      ),
    );
  }
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Unit —Ç–µ—Å—Ç—ã

```dart
// test/cozmo_eye_animation_controller_test.dart
import 'package:flutter_test/flutter_test.dart';
import 'package:cozmo_dart_lib/cozmo_dart_lib.dart';

void main() {
  group('EyeAnimationController Tests', () {
    late EyeAnimationController eyeController;
    late MockCozmoClient mockClient;
    late CozmoFace face;
    late MockCozmoAnimController mockAnimController;
    
    setUp(() {
      mockClient = MockCozmoClient();
      face = CozmoFace();
      mockAnimController = MockCozmoAnimController();
      eyeController = EyeAnimationController(mockClient, face, mockAnimController);
    });
    
    tearDown(() {
      eyeController.deactivate();
    });
    
    test('activate() should start wandering animation', () {
      eyeController.activate();
      
      expect(eyeController.isActive, true);
      expect(eyeController.currentAnimation, EyeAnimationType.wander);
    });
    
    test('blink() should temporarily close and open eyelids', () async {
      eyeController.activate();
      
      // –ù–∞—á–∏–Ω–∞–µ–º –º–æ—Ä–≥–∞–Ω–∏–µ
      eyeController.blink();
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤–µ–∫–∏ –∑–∞–∫—Ä—ã—Ç—ã
      expect(face._leftEyelid, 1.0);
      expect(face._rightEyelid, 1.0);
      
      // –ñ–¥–µ–º –æ–∫–æ–Ω—á–∞–Ω–∏—è –º–æ—Ä–≥–∞–Ω–∏—è
      await Future.delayed(Duration(milliseconds: 200));
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤–µ–∫–∏ –æ—Ç–∫—Ä—ã—Ç—ã
      expect(face._leftEyelid, 0.0);
      expect(face._rightEyelid, 0.0);
    });
    
    test('setHappy() should set happy expression', () {
      eyeController.activate();
      
      eyeController.setHappy();
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—á–∞—Å—Ç–ª–∏–≤—ã—Ö –≥–ª–∞–∑
      expect(face._leftEyeSize, 0.28);
      expect(face._rightEyeSize, 0.28);
      expect(face._leftEyelid, -0.1);
      expect(face._rightEyelid, -0.1);
    });
  });
}
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

```dart
// test/cozmo_eye_integration_test.dart
import 'package:flutter_test/flutter_test.dart';
import 'package:cozmo_dart_lib/cozmo_dart_lib.dart';

void main() {
  group('Eye Animation Integration Tests', () {
    testWidgets('Eyes should animate after robot connection', (WidgetTester tester) async {
      final robot = CozmoRobot.instance;
      
      // –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ —Ä–æ–±–æ—Ç—É
      final error = await robot.connect();
      expect(error, isNull);
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –≥–ª–∞–∑ –∞–∫—Ç–∏–≤–µ–Ω
      expect(robot.eyeController.isActive, true);
      expect(robot.eyeController.currentAnimation, EyeAnimationType.wander);
      
      // –û—Ç–∫–ª—é—á–∞–µ–º—Å—è
      robot.disconnect();
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –≥–ª–∞–∑ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω
      expect(robot.eyeController.isActive, false);
    });
  });
}
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

```dart
/// –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –∞–Ω–∏–º–∞—Ü–∏–∏ –≥–ª–∞–∑ —Ä–æ–±–æ—Ç–∞ Cozmo
/// 
/// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ —Ä–æ–±–æ—Ç—É
/// –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã –∞–Ω–∏–º–∞—Ü–∏–π –≥–ª–∞–∑.
/// 
/// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
/// ```dart
/// final robot = CozmoRobot.instance;
/// await robot.connect();
/// 
/// // –û–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ–µ –º–æ—Ä–≥–∞–Ω–∏–µ
/// robot.eyeController.blink();
/// 
/// // –¶–∏–∫–ª–∏—á–µ—Å–∫–æ–µ –º–æ—Ä–≥–∞–Ω–∏–µ –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã
/// robot.eyeController.startBlinkLoop(interval: Duration(seconds: 3));
/// 
/// // –°—á–∞—Å—Ç–ª–∏–≤–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ
/// robot.eyeController.setHappy();
/// 
/// // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∞–Ω–∏–º–∞—Ü–∏–π
/// robot.eyeController.stopAnimation();
/// ```
class EyeAnimationController {
  /// –°–æ–∑–¥–∞–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –∞–Ω–∏–º–∞—Ü–∏–∏ –≥–ª–∞–∑
  /// 
  /// [client] - –∫–ª–∏–µ–Ω—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–º–∞–Ω–¥
  /// [face] - –æ–±—ä–µ–∫—Ç –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è –ª–∏—Ü–∞
  /// [animController] - –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
  EyeAnimationController(this.client, this.face, this.animController);
  
  /// –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∞–Ω–∏–º–∞—Ü–∏—é –æ–∂–∏–¥–∞–Ω–∏—è
  /// 
  /// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ —Ä–æ–±–æ—Ç—É
  void activate();
  
  /// –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ –∞–Ω–∏–º–∞—Ü–∏–∏
  /// 
  /// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ –æ—Ç —Ä–æ–±–æ—Ç–∞
  void deactivate();
  
  /// –ó–∞–ø—É—Å–∫–∞–µ—Ç —É–∫–∞–∑–∞–Ω–Ω—É—é –∞–Ω–∏–º–∞—Ü–∏—é
  /// 
  /// [type] - —Ç–∏–ø –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞
  void startAnimation(EyeAnimationType type);
  
  /// –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–µ–∫—É—â—É—é –∞–Ω–∏–º–∞—Ü–∏—é
  void stopAnimation();
  
  /// –í—ã–ø–æ–ª–Ω—è–µ—Ç –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ–µ –º–æ—Ä–≥–∞–Ω–∏–µ
  void blink();
  
  /// –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–µ –º–æ—Ä–≥–∞–Ω–∏–µ
  /// 
  /// [interval] - –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –º–æ—Ä–≥–∞–Ω–∏—è–º–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 4 —Å–µ–∫—É–Ω–¥—ã)
  void startBlinkLoop({Duration? interval});
  
  /// –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–µ –º–æ—Ä–≥–∞–Ω–∏–µ
  void stopBlinkLoop();
  
  /// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—á–∞—Å—Ç–ª–∏–≤–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –≥–ª–∞–∑
  void setHappy();
  
  /// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≥—Ä—É—Å—Ç–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –≥–ª–∞–∑
  void setSad();
  
  /// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —É–¥–∏–≤–ª–µ–Ω–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –≥–ª–∞–∑
  void setSurprised();
  
  /// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –¥—É–º–∞—é—â–µ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –≥–ª–∞–∑
  void setThinking();
  
  /// –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
  bool get isActive;
  
  /// –¢–µ–∫—É—â–∞—è –≤—ã–ø–æ–ª–Ω—è–µ–º–∞—è –∞–Ω–∏–º–∞—Ü–∏—è
  EyeAnimationType get currentAnimation;
}
```

## üöÄ –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

### –≠—Ç–∞–ø 1: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞

1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `cozmo_eye_animation_controller.dart`
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–ª–∞—Å—Å–∞
3. –î–æ–±–∞–≤–∏—Ç—å –≤ `cozmo_dart_lib.dart` —ç–∫—Å–ø–æ—Ä—Ç

### –≠—Ç–∞–ø 2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CozmoRobot

1. –î–æ–±–∞–≤–∏—Ç—å `eyeController` –≤ `CozmoRobot`
2. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∞–∫—Ç–∏–≤–∞—Ü–∏—é –≤ `connect()`
3. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—é –≤ `disconnect()`

### –≠—Ç–∞–ø 3: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–Ω–∏–º–∞—Ü–∏–π

1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ (blink, wander, sleep)
2. –î–æ–±–∞–≤–∏—Ç—å —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ (happy, sad, surprised)
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –≠—Ç–∞–ø 4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å FlutterFlow

1. –°–æ–∑–¥–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
2. –°–æ–∑–¥–∞—Ç—å UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
3. –î–æ–±–∞–≤–∏—Ç—å –≤ –≥–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –≠—Ç–∞–ø 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –ù–∞–ø–∏—Å–∞—Ç—å unit —Ç–µ—Å—Ç—ã
2. –ù–∞–ø–∏—Å–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
3. –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ä—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

1. **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**:
   - –í—Å–µ –∞–Ω–∏–º–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
   - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏

2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**:
   - –ê–Ω–∏–º–∞—Ü–∏–∏ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ç—å
   - –ü–ª–∞–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –±–µ–∑ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π

3. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**:
   - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
   - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
   - –£—Å—Ç–æ–π—á–∏–≤–∞—è —Ä–∞–±–æ—Ç–∞ –ø—Ä–∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏

---

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 2026-01-10  
**–ê–≤—Ç–æ—Ä:** Cozmo Development Team